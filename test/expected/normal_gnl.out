--#
--#       Gpu Nest Loop Normal TestCases
--#
--#  [TODO] Gpu Nest Loop with Cross Join has not yet supported.
--#  [TODO] In depth larger than 1, Gpu Nest Loop has never been selected.
--#
set pg_strom.gpu_setup_cost=0;
set enable_nestloop to off;
-- ## SMALLINT ##
-- Inner join
select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x > s2.smlint_x) as t where t.rowid%10000=0;
 rowid  |  id  | smlint_x | id2  | smlint_x 
--------+------+----------+------+----------
  10000 |  261 |       27 | 8932 |        2
  20000 |  471 |       23 | 5412 |       14
  30000 |  671 |       30 | 3692 |       23
  40000 |  891 |       15 | 9602 |        9
  50000 | 1121 |       24 | 9582 |       16
  60000 | 1351 |       23 | 8862 |       22
  70000 | 1561 |       26 |  532 |       21
  80000 | 1741 |       19 | 2872 |       11
  90000 | 1971 |       12 | 9312 |        9
 100000 | 2231 |       29 | 8382 |       13
 110000 | 2471 |       28 | 3012 |       25
 120000 | 2631 |       32 | 7282 |        0
 130000 | 2841 |       20 | 8562 |       11
 140000 | 3021 |       27 | 3222 |       16
 150000 | 3211 |       14 | 1302 |       13
 160000 | 3411 |       31 | 8482 |        5
 170000 | 3631 |       30 | 8262 |       12
 180000 | 3901 |       14 | 7892 |       10
 190000 | 4171 |       21 | 8422 |        1
 200000 | 4351 |       21 | 8112 |        0
 210000 | 4531 |       15 | 3022 |       10
 220000 | 4731 |       13 | 9602 |        9
 230000 | 4971 |       19 | 9012 |       13
 240000 | 5211 |       32 | 3632 |        5
 250000 | 5391 |       11 | 1212 |        3
 260000 | 5591 |       30 | 5002 |       14
 270000 | 5861 |       18 | 3242 |       14
 280000 | 6071 |       12 | 3872 |       10
 290000 | 6331 |       23 | 2442 |        3
 300000 | 6581 |        5 | 9872 |        3
 310000 | 6851 |       18 | 7012 |        1
 320000 | 7091 |        6 | 7652 |        4
 330000 | 7401 |       31 | 3642 |        3
 340000 | 7631 |       25 | 2442 |        3
 350000 | 7911 |        7 |   92 |        2
 360000 | 8151 |       23 | 6942 |       22
 370000 | 8361 |        3 | 5052 |        2
 380000 | 8571 |       26 | 7582 |        6
 390000 | 8781 |       25 | 1722 |       10
 400000 | 9041 |       22 | 8582 |       19
 410000 | 9311 |       22 | 8642 |       18
 420000 | 9591 |       15 | 6462 |       12
 430000 | 9781 |       27 | 5272 |        4
(43 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x < s2.smlint_x) as t where t.rowid%10000=0;
 rowid  |  id  | smlint_x | id2  | smlint_x 
--------+------+----------+------+----------
  10000 |  201 |        5 |  362 |       24
  20000 |  431 |       10 |  102 |       18
  30000 |  691 |       10 | 8572 |       18
  40000 |  911 |       19 | 3822 |       27
  50000 | 1131 |        2 | 5482 |       14
  60000 | 1381 |        8 | 9562 |       32
  70000 | 1671 |        0 |  392 |       11
  80000 | 1921 |        4 | 3342 |       11
  90000 | 2151 |        6 |    2 |       21
 100000 | 2341 |        9 | 5902 |       22
 110000 | 2611 |       24 | 1922 |       29
 120000 | 2901 |       14 | 4052 |       22
 130000 | 3191 |       11 | 2562 |       32
 140000 | 3401 |        4 | 8802 |       13
 150000 | 3651 |       24 | 9462 |       29
 160000 | 3841 |       12 | 3692 |       23
 170000 | 4071 |       14 | 6162 |       20
 180000 | 4331 |       11 | 2942 |       32
 190000 | 4591 |       21 | 4772 |       26
 200000 | 4831 |        8 | 7272 |       19
 210000 | 5081 |       18 | 7192 |       28
 220000 | 5371 |        8 | 8822 |       23
 230000 | 5631 |        8 | 3472 |       22
 240000 | 5821 |       12 | 7862 |       16
 250000 | 6071 |       12 |  912 |       25
 260000 | 6261 |       19 | 9942 |       32
 270000 | 6491 |        9 | 7962 |       20
 280000 | 6711 |       26 |  562 |       31
 290000 | 6901 |        7 | 6162 |       20
 300000 | 7111 |        9 | 9642 |       11
 310000 | 7351 |        7 | 3702 |       18
 320000 | 7561 |       13 | 5092 |       17
 330000 | 7771 |        5 | 1702 |       17
 340000 | 7931 |       21 |  352 |       26
 350000 | 8131 |        4 | 2732 |       24
 360000 | 8341 |       10 | 6352 |       12
 370000 | 8591 |       22 | 1172 |       30
 380000 | 8811 |        9 | 8152 |       10
 390000 | 9021 |        3 | 8922 |       24
 400000 | 9211 |        4 | 8292 |       13
 410000 | 9391 |        3 | 2932 |       16
 420000 | 9571 |        7 | 3342 |       11
 430000 | 9871 |        2 | 6372 |       18
(43 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x >= s2.smlint_x) as t where t.rowid%10000=0;
 rowid  |  id  | smlint_x | id2  | smlint_x 
--------+------+----------+------+----------
  10000 |  251 |       13 | 9342 |       12
  20000 |  451 |       28 | 8332 |       27
  30000 |  641 |       15 | 9122 |       13
  40000 |  831 |       28 | 7002 |       13
  50000 | 1081 |       28 | 3062 |        2
  60000 | 1301 |       31 | 7992 |       10
  70000 | 1481 |       22 | 4072 |        3
  80000 | 1641 |       16 | 5702 |        4
  90000 | 1821 |       28 | 8922 |       24
 100000 | 2111 |       28 |  532 |       21
 110000 | 2311 |       22 | 5952 |        7
 120000 | 2531 |       25 | 7662 |        9
 130000 | 2691 |       15 | 2922 |        5
 140000 | 2881 |       28 | 7982 |       11
 150000 | 3061 |       25 | 7582 |        6
 160000 | 3241 |       20 | 8392 |        1
 170000 | 3441 |       20 |  292 |        5
 180000 | 3641 |       30 | 1622 |        7
 190000 | 3891 |       27 | 9272 |       13
 200000 | 4141 |       26 | 4472 |       26
 210000 | 4321 |       26 | 8812 |       11
 220000 | 4481 |       31 | 9442 |        8
 230000 | 4681 |       30 | 1912 |       21
 240000 | 4911 |       32 | 2762 |       14
 250000 | 5111 |       30 | 7442 |        7
 260000 | 5311 |        8 | 7452 |        8
 270000 | 5511 |       24 | 3342 |       11
 280000 | 5711 |       31 | 6702 |       19
 290000 | 5941 |       13 | 7882 |        1
 300000 | 6151 |       30 | 7952 |       27
 310000 | 6391 |        9 | 5662 |        2
 320000 | 6671 |        6 | 9532 |        4
 330000 | 6891 |       14 | 3502 |        1
 340000 | 7131 |        3 | 7882 |        1
 350000 | 7401 |       31 | 6882 |       18
 360000 | 7621 |        8 | 3042 |        7
 370000 | 7861 |       19 | 4822 |        9
 380000 | 8111 |       33 | 1402 |       18
 390000 | 8301 |       10 | 3772 |        1
 400000 | 8501 |       25 | 2782 |        4
 410000 | 8711 |       19 | 9862 |        9
 420000 | 8891 |        4 | 6052 |        4
 430000 | 9171 |       11 | 6262 |        4
 440000 | 9431 |       22 | 6312 |        7
 450000 | 9681 |       25 | 1082 |       22
 460000 | 9821 |       32 | 9582 |       16
(46 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x <= s2.smlint_x) as t where t.rowid%10000=0;
 rowid  |  id  | smlint_x | id2  | smlint_x 
--------+------+----------+------+----------
  10000 |  191 |       13 | 1372 |       14
  20000 |  401 |       12 | 3972 |       16
  30000 |  641 |       15 | 8252 |       29
  40000 |  851 |        3 | 5502 |       24
  50000 | 1061 |       19 | 9092 |       25
  60000 | 1251 |        4 | 4642 |       28
  70000 | 1521 |        1 | 8452 |       28
  80000 | 1801 |       19 | 3932 |       29
  90000 | 2011 |       11 | 9052 |       14
 100000 | 2211 |       10 | 9432 |       12
 110000 | 2401 |        0 | 7662 |        9
 120000 | 2691 |       15 | 6332 |       21
 130000 | 2971 |       14 | 1512 |       29
 140000 | 3221 |       18 | 1382 |       24
 150000 | 3421 |        4 | 8222 |       19
 160000 | 3661 |       18 | 4842 |       27
 170000 | 3831 |        1 | 9882 |       32
 180000 | 4061 |       13 | 2082 |       27
 190000 | 4281 |       25 | 8492 |       26
 200000 | 4541 |       11 | 4212 |       31
 210000 | 4801 |        2 | 2642 |       17
 220000 | 5011 |       13 |   82 |       29
 230000 | 5251 |       24 | 7252 |       33
 240000 | 5481 |       11 | 9982 |       18
 250000 | 5721 |        4 | 6572 |       28
 260000 | 5911 |       14 | 7822 |       14
 270000 | 6131 |       14 | 7872 |       27
 280000 | 6361 |        9 | 5022 |       16
 290000 | 6541 |       28 | 6572 |       28
 300000 | 6751 |       23 | 1892 |       32
 310000 | 6941 |       14 | 3822 |       27
 320000 | 7141 |       14 |  962 |       15
 330000 | 7351 |        7 | 8722 |       18
 340000 | 7561 |       13 | 2832 |       18
 350000 | 7751 |       10 | 9212 |       23
 360000 | 7911 |        7 | 1692 |       19
 370000 | 8091 |        7 | 3342 |       11
 380000 | 8301 |       10 | 6482 |       13
 390000 | 8521 |        4 | 5922 |       20
 400000 | 8741 |       13 | 2392 |       30
 410000 | 8951 |       26 | 4102 |       26
 420000 | 9151 |        7 |  722 |       33
 430000 | 9291 |        4 | 6742 |       10
 440000 | 9461 |        4 | 9702 |       21
 450000 | 9681 |       25 | 8232 |       28
 460000 | 9941 |       17 |  552 |       24
(46 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x between s2.smlint_x and s2.smlint_x+100) as t where t.rowid%10000=0;
 rowid  |  id  | smlint_x | id2  | smlint_x 
--------+------+----------+------+----------
  10000 |  251 |       13 | 9342 |       12
  20000 |  451 |       28 | 8332 |       27
  30000 |  641 |       15 | 9122 |       13
  40000 |  831 |       28 | 7002 |       13
  50000 | 1081 |       28 | 3062 |        2
  60000 | 1301 |       31 | 7992 |       10
  70000 | 1481 |       22 | 4072 |        3
  80000 | 1641 |       16 | 5702 |        4
  90000 | 1821 |       28 | 8922 |       24
 100000 | 2111 |       28 |  532 |       21
 110000 | 2311 |       22 | 5952 |        7
 120000 | 2531 |       25 | 7662 |        9
 130000 | 2691 |       15 | 2922 |        5
 140000 | 2881 |       28 | 7982 |       11
 150000 | 3061 |       25 | 7582 |        6
 160000 | 3241 |       20 | 8392 |        1
 170000 | 3441 |       20 |  292 |        5
 180000 | 3641 |       30 | 1622 |        7
 190000 | 3891 |       27 | 9272 |       13
 200000 | 4141 |       26 | 4472 |       26
 210000 | 4321 |       26 | 8812 |       11
 220000 | 4481 |       31 | 9442 |        8
 230000 | 4681 |       30 | 1912 |       21
 240000 | 4911 |       32 | 2762 |       14
 250000 | 5111 |       30 | 7442 |        7
 260000 | 5311 |        8 | 7452 |        8
 270000 | 5511 |       24 | 3342 |       11
 280000 | 5711 |       31 | 6702 |       19
 290000 | 5941 |       13 | 7882 |        1
 300000 | 6151 |       30 | 7952 |       27
 310000 | 6391 |        9 | 5662 |        2
 320000 | 6671 |        6 | 9532 |        4
 330000 | 6891 |       14 | 3502 |        1
 340000 | 7131 |        3 | 7882 |        1
 350000 | 7401 |       31 | 6882 |       18
 360000 | 7621 |        8 | 3042 |        7
 370000 | 7861 |       19 | 4822 |        9
 380000 | 8111 |       33 | 1402 |       18
 390000 | 8301 |       10 | 3772 |        1
 400000 | 8501 |       25 | 2782 |        4
 410000 | 8711 |       19 | 9862 |        9
 420000 | 8891 |        4 | 6052 |        4
 430000 | 9171 |       11 | 6262 |        4
 440000 | 9431 |       22 | 6312 |        7
 450000 | 9681 |       25 | 1082 |       22
 460000 | 9821 |       32 | 9582 |       16
(46 rows)

--Left outer join
select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x > s2.smlint_x) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   | smlint_x | id2 | smlint_x 
--------+-------+----------+-----+----------
   2000 |    75 |       18 |     |         
 115000 |  2520 |       26 |     |         
 175000 |  3653 |        7 |     |         
 209000 |  4435 |       11 |     |         
 254000 |  5364 |       32 |     |         
 259000 |  5474 |        8 |     |         
 271000 |  5753 |        3 |     |         
 449000 | 10217 |      -25 |     |         
 450000 | 11217 |      -29 |     |         
 451000 | 12217 |      -20 |     |         
 452000 | 13217 |      -16 |     |         
 453000 | 14217 |      -12 |     |         
 454000 | 15217 |       -2 |     |         
 455000 | 16217 |      -26 |     |         
 456000 | 17217 |      -21 |     |         
 457000 | 18217 |      -29 |     |         
 458000 | 19217 |      -25 |     |         
 459000 | 20217 |          |     |         
 460000 | 21217 |      -18 |     |         
 461000 | 22217 |       32 |     |         
 462000 | 23217 |      -13 |     |         
 463000 | 24217 |       24 |     |         
 464000 | 25217 |      -12 |     |         
 465000 | 26217 |       -2 |     |         
 466000 | 27217 |      -18 |     |         
 467000 | 28217 |       12 |     |         
 468000 | 29217 |        6 |     |         
 469000 | 30217 |          |     |         
 470000 | 31217 |          |     |         
 471000 | 32217 |          |     |         
 472000 | 33217 |          |     |         
 473000 | 34217 |          |     |         
 474000 | 35217 |          |     |         
 475000 | 36217 |          |     |         
 476000 | 37217 |          |     |         
 477000 | 38217 |          |     |         
 478000 | 39217 |          |     |         
(37 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x < s2.smlint_x) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   | smlint_x | id2 | smlint_x 
--------+-------+----------+-----+----------
  18000 |   357 |       13 |     |         
  33000 |   758 |        4 |     |         
  55000 |  1198 |        6 |     |         
  68000 |  1541 |          |     |         
 136000 |  3245 |        4 |     |         
 176000 |  4149 |       13 |     |         
 194000 |  4587 |       25 |     |         
 195000 |  4613 |        4 |     |         
 272000 |  6420 |        8 |     |         
 402000 |  9114 |        7 |     |         
 445000 | 10165 |      -28 |     |         
 446000 | 11165 |      -16 |     |         
 447000 | 12165 |      -18 |     |         
 448000 | 13165 |      -16 |     |         
 449000 | 14165 |       -2 |     |         
 450000 | 15165 |       -5 |     |         
 451000 | 16165 |      -19 |     |         
 452000 | 17165 |      -26 |     |         
 453000 | 18165 |      -23 |     |         
 454000 | 19165 |      -29 |     |         
 455000 | 20165 |      -17 |     |         
 456000 | 21165 |      -11 |     |         
 457000 | 22165 |       31 |     |         
 458000 | 23165 |      -16 |     |         
 459000 | 24165 |      -23 |     |         
 460000 | 25165 |       -6 |     |         
 461000 | 26165 |       -9 |     |         
 462000 | 27165 |       16 |     |         
 463000 | 28165 |        6 |     |         
 464000 | 29165 |       24 |     |         
 465000 | 30165 |          |     |         
 466000 | 31165 |          |     |         
 467000 | 32165 |          |     |         
 468000 | 33165 |          |     |         
 469000 | 34165 |          |     |         
 470000 | 35165 |          |     |         
 471000 | 36165 |          |     |         
 472000 | 37165 |          |     |         
 473000 | 38165 |          |     |         
 474000 | 39165 |          |     |         
(40 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x >= s2.smlint_x) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   | smlint_x | id2 | smlint_x 
--------+-------+----------+-----+----------
  27000 |   570 |       16 |     |         
  54000 |  1125 |       10 |     |         
 239000 |  4772 |       26 |     |         
 261000 |  5254 |       33 |     |         
 281000 |  5602 |       12 |     |         
 357000 |  7410 |          |     |         
 405000 |  8449 |       21 |     |         
 421000 |  8766 |        9 |     |         
 476000 | 10271 |      -20 |     |         
 477000 | 11271 |      -12 |     |         
 478000 | 12271 |          |     |         
 479000 | 13271 |       -9 |     |         
 480000 | 14271 |       -5 |     |         
 481000 | 15271 |      -14 |     |         
 482000 | 16271 |      -10 |     |         
 483000 | 17271 |       -3 |     |         
 484000 | 18271 |      -19 |     |         
 485000 | 19271 |      -32 |     |         
 486000 | 20271 |      -23 |     |         
 487000 | 21271 |      -11 |     |         
 488000 | 22271 |      -19 |     |         
 489000 | 23271 |       -6 |     |         
 490000 | 24271 |       28 |     |         
 491000 | 25271 |       30 |     |         
 492000 | 26271 |       -4 |     |         
 493000 | 27271 |          |     |         
 494000 | 28271 |       29 |     |         
 495000 | 29271 |       12 |     |         
 496000 | 30271 |          |     |         
 497000 | 31271 |          |     |         
 498000 | 32271 |          |     |         
 499000 | 33271 |          |     |         
 500000 | 34271 |          |     |         
 501000 | 35271 |          |     |         
 502000 | 36271 |          |     |         
 503000 | 37271 |          |     |         
 504000 | 38271 |          |     |         
 505000 | 39271 |          |     |         
(38 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x <= s2.smlint_x) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   | smlint_x | id2 | smlint_x 
--------+-------+----------+-----+----------
  51000 |  1062 |        3 |     |         
 139000 |  3116 |        3 |     |         
 146000 |  3280 |       27 |     |         
 159000 |  3556 |       19 |     |         
 176000 |  3906 |       26 |     |         
 236000 |  5292 |          |     |         
 352000 |  7649 |       12 |     |         
 437000 |  9266 |       14 |     |         
 472000 | 10217 |      -25 |     |         
 473000 | 11217 |      -29 |     |         
 474000 | 12217 |      -20 |     |         
 475000 | 13217 |      -16 |     |         
 476000 | 14217 |      -12 |     |         
 477000 | 15217 |       -2 |     |         
 478000 | 16217 |      -26 |     |         
 479000 | 17217 |      -21 |     |         
 480000 | 18217 |      -29 |     |         
 481000 | 19217 |      -25 |     |         
 482000 | 20217 |          |     |         
 483000 | 21217 |      -18 |     |         
 484000 | 22217 |       32 |     |         
 485000 | 23217 |      -13 |     |         
 486000 | 24217 |       24 |     |         
 487000 | 25217 |      -12 |     |         
 488000 | 26217 |       -2 |     |         
 489000 | 27217 |      -18 |     |         
 490000 | 28217 |       12 |     |         
 491000 | 29217 |        6 |     |         
 492000 | 30217 |          |     |         
 493000 | 31217 |          |     |         
 494000 | 32217 |          |     |         
 495000 | 33217 |          |     |         
 496000 | 34217 |          |     |         
 497000 | 35217 |          |     |         
 498000 | 36217 |          |     |         
 499000 | 37217 |          |     |         
 500000 | 38217 |          |     |         
 501000 | 39217 |          |     |         
(38 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x between s2.smlint_x and s2.smlint_x+100) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   | smlint_x | id2 | smlint_x 
--------+-------+----------+-----+----------
  27000 |   570 |       16 |     |         
  54000 |  1125 |       10 |     |         
 239000 |  4772 |       26 |     |         
 261000 |  5254 |       33 |     |         
 281000 |  5602 |       12 |     |         
 357000 |  7410 |          |     |         
 405000 |  8449 |       21 |     |         
 421000 |  8766 |        9 |     |         
 476000 | 10271 |      -20 |     |         
 477000 | 11271 |      -12 |     |         
 478000 | 12271 |          |     |         
 479000 | 13271 |       -9 |     |         
 480000 | 14271 |       -5 |     |         
 481000 | 15271 |      -14 |     |         
 482000 | 16271 |      -10 |     |         
 483000 | 17271 |       -3 |     |         
 484000 | 18271 |      -19 |     |         
 485000 | 19271 |      -32 |     |         
 486000 | 20271 |      -23 |     |         
 487000 | 21271 |      -11 |     |         
 488000 | 22271 |      -19 |     |         
 489000 | 23271 |       -6 |     |         
 490000 | 24271 |       28 |     |         
 491000 | 25271 |       30 |     |         
 492000 | 26271 |       -4 |     |         
 493000 | 27271 |          |     |         
 494000 | 28271 |       29 |     |         
 495000 | 29271 |       12 |     |         
 496000 | 30271 |          |     |         
 497000 | 31271 |          |     |         
 498000 | 32271 |          |     |         
 499000 | 33271 |          |     |         
 500000 | 34271 |          |     |         
 501000 | 35271 |          |     |         
 502000 | 36271 |          |     |         
 503000 | 37271 |          |     |         
 504000 | 38271 |          |     |         
 505000 | 39271 |          |     |         
(38 rows)

--Right Outer Join ( REVERSE inner and outer )
select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x > s2.smlint_x) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | smlint_x |  id2  | smlint_x 
--------+----+----------+-------+----------
 440000 |    |          |   318 |        7
 441000 |    |          |  1423 |       16
 442000 |    |          |  2524 |        7
 443000 |    |          |  3630 |       26
 444000 |    |          |  4734 |       17
 445000 |    |          |  5840 |        5
 446000 |    |          |  6945 |       26
 447000 |    |          |  8049 |       27
 448000 |    |          |  9156 |       20
 449000 |    |          | 10238 |      -26
 450000 |    |          | 11238 |       -5
 451000 |    |          | 12238 |      -14
 452000 |    |          | 13238 |      -19
 453000 |    |          | 14238 |      -19
 454000 |    |          | 15238 |      -12
 455000 |    |          | 16238 |      -30
 456000 |    |          | 17238 |       -8
 457000 |    |          | 18238 |      -10
 458000 |    |          | 19238 |      -12
 459000 |    |          | 20238 |       -8
 460000 |    |          | 21238 |       23
 461000 |    |          | 22238 |       30
 462000 |    |          | 23238 |       16
 463000 |    |          | 24238 |       -4
 464000 |    |          | 25238 |      -26
 465000 |    |          | 26238 |       19
 466000 |    |          | 27238 |      -11
 467000 |    |          | 28238 |       28
 468000 |    |          | 29238 |       21
 469000 |    |          | 30238 |         
 470000 |    |          | 31238 |         
 471000 |    |          | 32238 |         
 472000 |    |          | 33238 |         
 473000 |    |          | 34238 |         
 474000 |    |          | 35238 |         
 475000 |    |          | 36238 |         
 476000 |    |          | 37238 |         
 477000 |    |          | 38238 |         
 478000 |    |          | 39238 |         
(39 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x < s2.smlint_x) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | smlint_x |  id2  | smlint_x 
--------+----+----------+-------+----------
 436000 |    |          |   259 |       12
 437000 |    |          |  1361 |       31
 438000 |    |          |  2460 |       28
 439000 |    |          |  3565 |       24
 440000 |    |          |  4668 |       29
 441000 |    |          |  5774 |       22
 442000 |    |          |  6879 |        6
 443000 |    |          |  7983 |       32
 444000 |    |          |  9084 |       32
 445000 |    |          | 10173 |      -16
 446000 |    |          | 11173 |       -4
 447000 |    |          | 12173 |      -18
 448000 |    |          | 13173 |      -14
 449000 |    |          | 14173 |       -6
 450000 |    |          | 15173 |      -22
 451000 |    |          | 16173 |      -25
 452000 |    |          | 17173 |      -21
 453000 |    |          | 18173 |      -25
 454000 |    |          | 19173 |      -28
 455000 |    |          | 20173 |      -22
 456000 |    |          | 21173 |       28
 457000 |    |          | 22173 |       27
 458000 |    |          | 23173 |      -23
 459000 |    |          | 24173 |        8
 460000 |    |          | 25173 |       20
 461000 |    |          | 26173 |      -16
 462000 |    |          | 27173 |      -10
 463000 |    |          | 28173 |      -14
 464000 |    |          | 29173 |      -29
 465000 |    |          | 30173 |         
 466000 |    |          | 31173 |         
 467000 |    |          | 32173 |         
 468000 |    |          | 33173 |         
 469000 |    |          | 34173 |         
 470000 |    |          | 35173 |         
 471000 |    |          | 36173 |         
 472000 |    |          | 37173 |         
 473000 |    |          | 38173 |         
 474000 |    |          | 39173 |         
(39 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x >= s2.smlint_x) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | smlint_x |  id2  | smlint_x 
--------+----+----------+-------+----------
 467000 |    |          |   361 |       28
 468000 |    |          |  1470 |       17
 469000 |    |          |  2571 |       31
 470000 |    |          |  3678 |       18
 471000 |    |          |  4783 |        6
 472000 |    |          |  5890 |       29
 473000 |    |          |  6996 |        0
 474000 |    |          |  8104 |        1
 475000 |    |          |  9210 |       29
 476000 |    |          | 10287 |      -13
 477000 |    |          | 11287 |      -12
 478000 |    |          | 12287 |      -23
 479000 |    |          | 13287 |       -7
 480000 |    |          | 14287 |      -13
 481000 |    |          | 15287 |       -5
 482000 |    |          | 16287 |      -19
 483000 |    |          | 17287 |      -21
 484000 |    |          | 18287 |       -6
 485000 |    |          | 19287 |        0
 486000 |    |          | 20287 |       -2
 487000 |    |          | 21287 |       -8
 488000 |    |          | 22287 |       20
 489000 |    |          | 23287 |         
 490000 |    |          | 24287 |         
 491000 |    |          | 25287 |      -33
 492000 |    |          | 26287 |      -21
 493000 |    |          | 27287 |       18
 494000 |    |          | 28287 |        6
 495000 |    |          | 29287 |       10
 496000 |    |          | 30287 |         
 497000 |    |          | 31287 |         
 498000 |    |          | 32287 |         
 499000 |    |          | 33287 |         
 500000 |    |          | 34287 |         
 501000 |    |          | 35287 |         
 502000 |    |          | 36287 |         
 503000 |    |          | 37287 |         
 504000 |    |          | 38287 |         
 505000 |    |          | 39287 |         
(39 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x <= s2.smlint_x) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | smlint_x |  id2  | smlint_x 
--------+----+----------+-------+----------
 463000 |    |          |   304 |       15
 464000 |    |          |  1411 |       11
 465000 |    |          |  2511 |       25
 466000 |    |          |  3619 |        2
 467000 |    |          |  4723 |       23
 468000 |    |          |  5830 |       17
 469000 |    |          |  6936 |        8
 470000 |    |          |  8044 |        9
 471000 |    |          |  9150 |       25
 472000 |    |          | 10233 |       -9
 473000 |    |          | 11233 |      -27
 474000 |    |          | 12233 |       -6
 475000 |    |          | 13233 |      -10
 476000 |    |          | 14233 |       -9
 477000 |    |          | 15233 |       -8
 478000 |    |          | 16233 |       -3
 479000 |    |          | 17233 |       -9
 480000 |    |          | 18233 |       -3
 481000 |    |          | 19233 |      -13
 482000 |    |          | 20233 |       25
 483000 |    |          | 21233 |       32
 484000 |    |          | 22233 |      -21
 485000 |    |          | 23233 |       24
 486000 |    |          | 24233 |      -31
 487000 |    |          | 25233 |       19
 488000 |    |          | 26233 |         
 489000 |    |          | 27233 |      -29
 490000 |    |          | 28233 |       -1
 491000 |    |          | 29233 |        4
 492000 |    |          | 30233 |         
 493000 |    |          | 31233 |         
 494000 |    |          | 32233 |         
 495000 |    |          | 33233 |         
 496000 |    |          | 34233 |         
 497000 |    |          | 35233 |         
 498000 |    |          | 36233 |         
 499000 |    |          | 37233 |         
 500000 |    |          | 38233 |         
 501000 |    |          | 39233 |         
(39 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x between s2.smlint_x and s2.smlint_x+100) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | smlint_x |  id2  | smlint_x 
--------+----+----------+-------+----------
 467000 |    |          |   361 |       28
 468000 |    |          |  1470 |       17
 469000 |    |          |  2571 |       31
 470000 |    |          |  3678 |       18
 471000 |    |          |  4783 |        6
 472000 |    |          |  5890 |       29
 473000 |    |          |  6996 |        0
 474000 |    |          |  8104 |        1
 475000 |    |          |  9210 |       29
 476000 |    |          | 10287 |      -13
 477000 |    |          | 11287 |      -12
 478000 |    |          | 12287 |      -23
 479000 |    |          | 13287 |       -7
 480000 |    |          | 14287 |      -13
 481000 |    |          | 15287 |       -5
 482000 |    |          | 16287 |      -19
 483000 |    |          | 17287 |      -21
 484000 |    |          | 18287 |       -6
 485000 |    |          | 19287 |        0
 486000 |    |          | 20287 |       -2
 487000 |    |          | 21287 |       -8
 488000 |    |          | 22287 |       20
 489000 |    |          | 23287 |         
 490000 |    |          | 24287 |         
 491000 |    |          | 25287 |      -33
 492000 |    |          | 26287 |      -21
 493000 |    |          | 27287 |       18
 494000 |    |          | 28287 |        6
 495000 |    |          | 29287 |       10
 496000 |    |          | 30287 |         
 497000 |    |          | 31287 |         
 498000 |    |          | 32287 |         
 499000 |    |          | 33287 |         
 500000 |    |          | 34287 |         
 501000 |    |          | 35287 |         
 502000 |    |          | 36287 |         
 503000 |    |          | 37287 |         
 504000 |    |          | 38287 |         
 505000 |    |          | 39287 |         
(39 rows)

--Full Join ( NOT supported error )
select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.smlint_x,s2.id as id2,s2.smlint_x from strom_test s1 FULL join strom_test s2 on s1.key=1 and s2.key=2 and s1.smlint_x > s2.smlint_x) as t where t.rowid%1000 = 0 and t.id is NULL;
ERROR:  FULL JOIN is only supported with merge-joinable or hash-joinable join conditions
-- ## FLOAT ##
-- Inner join
select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x > s2.float_x) as t where t.rowid%10000=0;
 rowid  |  id  |     float_x     | id2  |     float_x     
--------+------+-----------------+------+-----------------
  10000 |  241 | 0.2788592088036 | 5472 | 0.0752203250304
  20000 |  521 | 0.5546963936649 | 1772 | 0.0029396908358
  30000 |  731 | 0.6438782275654 | 4052 |  0.434645507019
  40000 |  951 | 0.8151664263569 | 5012 | 0.0573768625036
  50000 | 1201 | 0.8835904658772 |   12 | 0.0041616088711
  60000 | 1401 | 0.8790396749973 | 4672 | 0.4282868010923
  70000 | 1601 | 0.7412554859184 | 4212 | 0.4527100096457
  80000 | 1821 | 0.6438406482339 | 2372 | 0.2829126776196
  90000 | 2031 | 0.3634373415262 | 5562 | 0.1225977954455
 100000 | 2251 | 0.7980955531821 | 1502 | 0.7355782799423
 110000 | 2421 | 0.8965014200658 | 7532 | 0.1201643655077
 120000 | 2631 | 0.5497722770087 |  372 | 0.2449636510573
 130000 | 2831 | 0.6359440605156 | 6672 | 0.4533208888024
 140000 | 3061 | 0.5908198240213 | 3722 | 0.0920733613893
 150000 | 3291 | 0.8759753573686 | 6292 | 0.4288481650874
 160000 | 3461 | 0.4820172069594 | 2302 | 0.1858946718276
 170000 | 3681 |   0.70498290658 | 3552 | 0.3223619768396
 180000 | 3881 | 0.9291602750309 | 3592 | 0.3850928470492
 190000 | 4111 | 0.7680858075619 | 6372 |  0.290855367668
 200000 | 4321 | 0.9220138904639 | 5872 | 0.7025373145007
 210000 | 4521 | 0.5490920711309 | 5542 | 0.4602192169987
 220000 | 4741 | 0.4811868490651 | 9352 |  0.107938349247
 230000 | 4941 | 0.8783761179075 | 3592 | 0.3850928470492
 240000 | 5171 | 0.3070168001577 | 6542 | 0.2182737533003
 250000 | 5371 | 0.6000688276254 | 6042 | 0.3609251519665
 260000 | 5581 | 0.2272242484614 | 3772 |  0.165452525951
 270000 | 5811 |  0.927273648791 |  982 | 0.9075779113919
 280000 | 6031 | 0.8412061007693 | 1992 | 0.3675199137069
 290000 | 6241 | 0.7512610098347 | 7352 | 0.5747396973893
 300000 | 6461 | 0.5675076115876 | 6242 | 0.1960514509119
 310000 | 6671 | 0.9366675796919 | 2702 | 0.5793188940734
 320000 | 6881 | 0.2950670197606 |   12 | 0.0041616088711
 330000 | 7111 | 0.8738597943448 | 2892 |  0.608747842256
 340000 | 7281 | 0.9876128863543 | 7102 | 0.3168262783438
 350000 | 7491 | 0.5344219421968 | 1902 | 0.0954804513603
 360000 | 7681 |  0.873475517612 | 9332 | 0.3792754169554
 370000 | 7911 | 0.5738320546225 | 2212 | 0.4012510855682
 380000 | 8081 | 0.6953013977036 | 7982 | 0.2342234910466
 390000 | 8311 | 0.8025675700046 | 3142 | 0.0798664386384
 400000 | 8471 | 0.6173748313449 | 5182 | 0.5892384210601
 410000 | 8641 | 0.2233307748102 | 9752 | 0.1822644700296
 420000 | 8921 | 0.6964557110332 | 2922 | 0.0958936447278
 430000 | 9111 | 0.5704421773553 | 1702 |  0.472271787934
 440000 | 9321 | 0.5524357035756 | 7952 | 0.3052713065408
 450000 | 9541 | 0.8094915128313 | 2642 |  0.199509783648
 460000 | 9701 | 0.9900471461006 | 5942 | 0.9025325169787
 470000 | 9921 | 0.9405613495037 |  992 | 0.6395937628113
(47 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x < s2.float_x) as t where t.rowid%10000=0;
 rowid  |  id  |     float_x     | id2  |     float_x     
--------+------+-----------------+------+-----------------
  10000 |  201 | 0.3209128351882 | 5582 | 0.4500208115205
  20000 |  391 | 0.4036146104336 | 8222 | 0.8936057747342
  30000 |  591 |  0.250361523591 | 6562 | 0.9937206129543
  40000 |  831 | 0.4083394110203 | 3542 | 0.7844722219743
  50000 | 1041 | 0.0530880377628 | 8852 | 0.9591446206905
  60000 | 1291 | 0.5761492941529 | 5072 | 0.8838296798058
  70000 | 1531 | 0.3408779157326 |  742 | 0.8665940240026
  80000 | 1741 | 0.6777098295279 |  832 | 0.7237731660716
  90000 | 1931 | 0.1557236309163 | 2732 | 0.4163756063208
 100000 | 2151 | 0.3653643075377 | 2992 | 0.4417630303651
 110000 | 2391 | 0.3826031768695 | 9772 | 0.8631919296458
 120000 | 2631 | 0.5497722770087 | 1782 | 0.6820594961755
 130000 | 2841 | 0.1315232585184 | 3832 | 0.8413396785036
 140000 | 3031 | 0.4272286542691 | 9022 | 0.5970776258036
 150000 | 3231 | 0.3765948070213 | 8832 | 0.4797365083359
 160000 | 3511 | 0.3889444968663 | 3812 | 0.4378775595687
 170000 | 3751 | 0.3580524749123 | 8312 | 0.7400339073502
 180000 | 4001 |  0.023031421937 | 5642 | 0.0378120583482
 190000 | 4221 |  0.435100751929 | 8732 | 0.9481555237435
 200000 | 4431 | 0.2289466201328 | 6552 | 0.3899491326883
 210000 | 4611 | 0.0614542663097 | 4262 | 0.8721626270562
 220000 | 4881 | 0.2402578806505 | 2472 | 0.4243650995195
 230000 | 5071 | 0.0378617257811 | 3352 |  0.541427588556
 240000 | 5301 | 0.3237509606406 | 5702 | 0.6086062081158
 250000 | 5541 | 0.0738680344075 | 9832 | 0.7650848343037
 260000 | 5771 | 0.1105069285259 | 1662 | 0.8299981784076
 270000 | 6011 | 0.5061242054217 |   32 | 0.5185148748569
 280000 | 6241 | 0.7512610098347 | 7632 | 0.9449898120947
 290000 | 6451 | 0.1608480289578 | 2702 | 0.5793188940734
 300000 | 6661 | 0.0411289515905 | 4902 | 0.9828797872178
 310000 | 6871 | 0.5883343783207 | 4282 |  0.678682197351
 320000 | 7091 | 0.0587364011444 | 8342 |  0.950583817903
 330000 | 7371 | 0.0171264107339 | 2532 |  0.715055574663
 340000 | 7601 | 0.2786178565584 |   22 | 0.8381336024031
 350000 | 7811 | 0.3302428536117 | 5142 | 0.3916303501464
 360000 | 8051 | 0.0800658441149 | 3982 | 0.3178672767244
 370000 | 8261 | 0.0872116792016 | 7072 | 0.4780024490319
 380000 | 8551 | 0.5163154713809 | 1782 | 0.6820594961755
 390000 | 8781 | 0.7441020542756 | 3842 | 0.8446492822841
 400000 | 9011 | 0.3528844434768 |  642 |  0.769133429043
 410000 | 9231 | 0.4442274128087 | 9392 | 0.6219733017497
 420000 | 9491 | 0.0948038930073 | 2542 | 0.1018237988465
 430000 | 9731 | 0.1432601287961 | 2782 | 0.3222971721552
 440000 | 9971 |  0.758077097591 | 4432 | 0.8764605685137
(44 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x >= s2.float_x) as t where t.rowid%10000=0;
 rowid  |  id  |     float_x     | id2  |     float_x     
--------+------+-----------------+------+-----------------
  10000 |  241 | 0.2788592088036 | 5472 | 0.0752203250304
  20000 |  521 | 0.5546963936649 | 1772 | 0.0029396908358
  30000 |  731 | 0.6438782275654 | 4052 |  0.434645507019
  40000 |  951 | 0.8151664263569 | 5012 | 0.0573768625036
  50000 | 1201 | 0.8835904658772 |   12 | 0.0041616088711
  60000 | 1401 | 0.8790396749973 | 4672 | 0.4282868010923
  70000 | 1601 | 0.7412554859184 | 4212 | 0.4527100096457
  80000 | 1821 | 0.6438406482339 | 2372 | 0.2829126776196
  90000 | 2031 | 0.3634373415262 | 5562 | 0.1225977954455
 100000 | 2251 | 0.7980955531821 | 1502 | 0.7355782799423
 110000 | 2421 | 0.8965014200658 | 7532 | 0.1201643655077
 120000 | 2631 | 0.5497722770087 |  372 | 0.2449636510573
 130000 | 2831 | 0.6359440605156 | 6672 | 0.4533208888024
 140000 | 3061 | 0.5908198240213 | 3722 | 0.0920733613893
 150000 | 3291 | 0.8759753573686 | 6292 | 0.4288481650874
 160000 | 3461 | 0.4820172069594 | 2302 | 0.1858946718276
 170000 | 3681 |   0.70498290658 | 3552 | 0.3223619768396
 180000 | 3881 | 0.9291602750309 | 3592 | 0.3850928470492
 190000 | 4111 | 0.7680858075619 | 6372 |  0.290855367668
 200000 | 4321 | 0.9220138904639 | 5872 | 0.7025373145007
 210000 | 4521 | 0.5490920711309 | 5542 | 0.4602192169987
 220000 | 4741 | 0.4811868490651 | 9352 |  0.107938349247
 230000 | 4941 | 0.8783761179075 | 3592 | 0.3850928470492
 240000 | 5171 | 0.3070168001577 | 6542 | 0.2182737533003
 250000 | 5371 | 0.6000688276254 | 6042 | 0.3609251519665
 260000 | 5581 | 0.2272242484614 | 3772 |  0.165452525951
 270000 | 5811 |  0.927273648791 |  982 | 0.9075779113919
 280000 | 6031 | 0.8412061007693 | 1992 | 0.3675199137069
 290000 | 6241 | 0.7512610098347 | 7352 | 0.5747396973893
 300000 | 6461 | 0.5675076115876 | 6242 | 0.1960514509119
 310000 | 6671 | 0.9366675796919 | 2702 | 0.5793188940734
 320000 | 6881 | 0.2950670197606 |   12 | 0.0041616088711
 330000 | 7111 | 0.8738597943448 | 2892 |  0.608747842256
 340000 | 7281 | 0.9876128863543 | 7102 | 0.3168262783438
 350000 | 7491 | 0.5344219421968 | 1902 | 0.0954804513603
 360000 | 7681 |  0.873475517612 | 9332 | 0.3792754169554
 370000 | 7911 | 0.5738320546225 | 2212 | 0.4012510855682
 380000 | 8081 | 0.6953013977036 | 7982 | 0.2342234910466
 390000 | 8311 | 0.8025675700046 | 3142 | 0.0798664386384
 400000 | 8471 | 0.6173748313449 | 5182 | 0.5892384210601
 410000 | 8641 | 0.2233307748102 | 9752 | 0.1822644700296
 420000 | 8921 | 0.6964557110332 | 2922 | 0.0958936447278
 430000 | 9111 | 0.5704421773553 | 1702 |  0.472271787934
 440000 | 9321 | 0.5524357035756 | 7952 | 0.3052713065408
 450000 | 9541 | 0.8094915128313 | 2642 |  0.199509783648
 460000 | 9701 | 0.9900471461006 | 5942 | 0.9025325169787
 470000 | 9921 | 0.9405613495037 |  992 | 0.6395937628113
(47 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x <= s2.float_x) as t where t.rowid%10000=0;
 rowid  |  id  |     float_x     | id2  |     float_x     
--------+------+-----------------+------+-----------------
  10000 |  201 | 0.3209128351882 | 5582 | 0.4500208115205
  20000 |  391 | 0.4036146104336 | 8222 | 0.8936057747342
  30000 |  591 |  0.250361523591 | 6562 | 0.9937206129543
  40000 |  831 | 0.4083394110203 | 3542 | 0.7844722219743
  50000 | 1041 | 0.0530880377628 | 8852 | 0.9591446206905
  60000 | 1291 | 0.5761492941529 | 5072 | 0.8838296798058
  70000 | 1531 | 0.3408779157326 |  742 | 0.8665940240026
  80000 | 1741 | 0.6777098295279 |  832 | 0.7237731660716
  90000 | 1931 | 0.1557236309163 | 2732 | 0.4163756063208
 100000 | 2151 | 0.3653643075377 | 2992 | 0.4417630303651
 110000 | 2391 | 0.3826031768695 | 9772 | 0.8631919296458
 120000 | 2631 | 0.5497722770087 | 1782 | 0.6820594961755
 130000 | 2841 | 0.1315232585184 | 3832 | 0.8413396785036
 140000 | 3031 | 0.4272286542691 | 9022 | 0.5970776258036
 150000 | 3231 | 0.3765948070213 | 8832 | 0.4797365083359
 160000 | 3511 | 0.3889444968663 | 3812 | 0.4378775595687
 170000 | 3751 | 0.3580524749123 | 8312 | 0.7400339073502
 180000 | 4001 |  0.023031421937 | 5642 | 0.0378120583482
 190000 | 4221 |  0.435100751929 | 8732 | 0.9481555237435
 200000 | 4431 | 0.2289466201328 | 6552 | 0.3899491326883
 210000 | 4611 | 0.0614542663097 | 4262 | 0.8721626270562
 220000 | 4881 | 0.2402578806505 | 2472 | 0.4243650995195
 230000 | 5071 | 0.0378617257811 | 3352 |  0.541427588556
 240000 | 5301 | 0.3237509606406 | 5702 | 0.6086062081158
 250000 | 5541 | 0.0738680344075 | 9832 | 0.7650848343037
 260000 | 5771 | 0.1105069285259 | 1662 | 0.8299981784076
 270000 | 6011 | 0.5061242054217 |   32 | 0.5185148748569
 280000 | 6241 | 0.7512610098347 | 7632 | 0.9449898120947
 290000 | 6451 | 0.1608480289578 | 2702 | 0.5793188940734
 300000 | 6661 | 0.0411289515905 | 4902 | 0.9828797872178
 310000 | 6871 | 0.5883343783207 | 4282 |  0.678682197351
 320000 | 7091 | 0.0587364011444 | 8342 |  0.950583817903
 330000 | 7371 | 0.0171264107339 | 2532 |  0.715055574663
 340000 | 7601 | 0.2786178565584 |   22 | 0.8381336024031
 350000 | 7811 | 0.3302428536117 | 5142 | 0.3916303501464
 360000 | 8051 | 0.0800658441149 | 3982 | 0.3178672767244
 370000 | 8261 | 0.0872116792016 | 7072 | 0.4780024490319
 380000 | 8551 | 0.5163154713809 | 1782 | 0.6820594961755
 390000 | 8781 | 0.7441020542756 | 3842 | 0.8446492822841
 400000 | 9011 | 0.3528844434768 |  642 |  0.769133429043
 410000 | 9231 | 0.4442274128087 | 9392 | 0.6219733017497
 420000 | 9491 | 0.0948038930073 | 2542 | 0.1018237988465
 430000 | 9731 | 0.1432601287961 | 2782 | 0.3222971721552
 440000 | 9971 |  0.758077097591 | 4432 | 0.8764605685137
(44 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 inner join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x between s2.float_x and s2.float_x+0.05) as t where t.rowid%1000=0;
 rowid |  id  |     float_x     | id2  |     float_x     
-------+------+-----------------+------+-----------------
  1000 |  221 | 0.0977210914716 | 3142 | 0.0798664386384
  2000 |  441 | 0.9562286953442 | 3212 | 0.9449208979495
  3000 |  671 | 0.7299687848426 | 2382 | 0.6888296669349
  4000 |  881 | 0.6714978511445 | 9272 | 0.6254429868422
  5000 | 1121 | 0.4152149516158 | 2622 | 0.3916873969138
  6000 | 1331 | 0.1655471250415 | 9442 | 0.1358619807288
  7000 | 1561 | 0.5813313582912 | 8612 | 0.5812410106882
  8000 | 1771 | 0.3518856647424 | 9952 | 0.3210773374885
  9000 | 1981 | 0.1460625603795 | 6482 | 0.1248931214213
 10000 | 2191 | 0.5433173775673 |  302 | 0.4967823885381
 11000 | 2391 | 0.3826031768695 | 7822 | 0.3590428060852
 12000 | 2611 | 0.5525679700077 | 3462 |  0.506222516764
 13000 | 2821 | 0.4484082916752 | 4792 | 0.4415508788079
 14000 | 3031 | 0.4272286542691 | 4862 | 0.3955886405893
 15000 | 3251 | 0.6485058455728 | 7322 | 0.6037427228875
 16000 | 3461 | 0.4820172069594 | 6742 | 0.4797036508098
 17000 | 3711 | 0.4054424604401 | 8282 |   0.37001599418
 18000 | 3921 | 0.1219073692337 | 8362 | 0.0734166209586
 19000 | 4181 | 0.4295822433196 | 9902 |  0.405489649158
 20000 | 4401 | 0.3567630141042 | 8912 | 0.3523479001597
 21000 | 4621 | 0.1870978958905 | 5912 | 0.1837465139106
 22000 | 4841 | 0.5146452761255 | 6532 | 0.4884665673599
 23000 | 5051 | 0.2389046396129 | 8962 |  0.189007316716
 24000 | 5291 | 0.6270170635544 | 4722 | 0.6258163461462
 25000 | 5511 | 0.1672080089338 | 9142 | 0.1359880524687
 26000 | 5741 | 0.8664575014263 | 1732 | 0.8524933191948
 27000 | 5981 | 0.5556603618898 | 4392 | 0.5149791524746
 28000 | 6211 | 0.3355147112161 | 6812 | 0.2979685612954
 29000 | 6431 | 0.1795450877398 | 1762 | 0.1546594467945
 30000 | 6631 | 0.4043565373868 | 6552 | 0.3899491326883
 31000 | 6861 |  0.788976111915 | 5092 | 0.7806665981188
 32000 | 7101 | 0.6895730579272 | 4852 | 0.6415683990344
 33000 | 7321 | 0.2001861818135 | 8962 |  0.189007316716
 34000 | 7561 | 0.7932629669085 | 5092 | 0.7806665981188
 35000 | 7801 | 0.9125670474023 | 3972 | 0.8666138504632
 36000 | 8021 | 0.8114303792827 |  262 | 0.8016026229598
 37000 | 8231 | 0.3296910836361 | 7582 | 0.3027196610346
 38000 | 8451 | 0.9901979146525 | 6722 | 0.9441705401987
 39000 | 8681 | 0.9353974061087 | 1692 | 0.9338749600574
 40000 | 8901 |  0.228485497646 | 9752 | 0.1822644700296
 41000 | 9131 | 0.4746738853864 |   72 | 0.4599365130998
 42000 | 9371 | 0.0707841804251 |  112 | 0.0443660859019
 43000 | 9581 | 0.8938755155541 | 1002 | 0.8885740395635
 44000 | 9801 | 0.7950793118216 | 5302 | 0.7878510807641
(44 rows)

--Left outer join
select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x > s2.float_x) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   |     float_x      | id2 | float_x 
--------+-------+------------------+-----+---------
 235000 |  4947 |  0.9546461026184 |     |        
 238000 |  4993 |  0.5296760927886 |     |        
 251000 |  5310 |  0.4098354117014 |     |        
 269000 |  5666 |  0.2084929337725 |     |        
 279000 |  5904 |  0.6457925979048 |     |        
 311000 |  6555 |  0.7979098763317 |     |        
 328000 |  6907 |  0.1040899110958 |     |        
 330000 |  6975 |  0.6300356592983 |     |        
 367000 |  7684 |  0.8649718449451 |     |        
 388000 |  8095 |  0.7262684474699 |     |        
 395000 |  8263 |  0.9835044625215 |     |        
 448000 |  9320 |  0.3965655490756 |     |        
 484000 | 10247 | -0.1091087879613 |     |        
 485000 | 11247 | -0.4987082369626 |     |        
 486000 | 12247 |                  |     |        
 487000 | 13247 | -0.1031628982164 |     |        
 488000 | 14247 | -0.0438272808678 |     |        
 489000 | 15247 | -0.9497834043577 |     |        
 490000 | 16247 | -0.9397828364745 |     |        
 491000 | 17247 | -0.8386867465451 |     |        
 492000 | 18247 | -0.7932289745659 |     |        
 493000 | 19247 |  -0.338393652346 |     |        
 494000 | 20247 |  0.1283479686826 |     |        
 495000 | 21247 |  0.2663934603333 |     |        
 496000 | 22247 |  0.3939843950793 |     |        
 497000 | 23247 | -0.5770079074427 |     |        
 498000 | 24247 |  -0.334325867705 |     |        
 499000 | 25247 |  0.1363662527874 |     |        
 500000 | 26247 | -0.5942816538736 |     |        
 501000 | 27247 | -0.8640322526917 |     |        
 502000 | 28247 |  0.3883382985368 |     |        
 503000 | 29247 | -0.5118093434721 |     |        
 504000 | 30247 |                  |     |        
 505000 | 31247 |                  |     |        
 506000 | 32247 |                  |     |        
 507000 | 33247 |                  |     |        
 508000 | 34247 |                  |     |        
 509000 | 35247 |                  |     |        
 510000 | 36247 |                  |     |        
 511000 | 37247 |                  |     |        
 512000 | 38247 |                  |     |        
 513000 | 39247 |                  |     |        
(42 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x < s2.float_x) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   |     float_x      | id2 | float_x 
--------+-------+------------------+-----+---------
 153000 |  3239 |  0.0483138062991 |     |        
 166000 |  3595 |  0.4805290321819 |     |        
 169000 |  3645 |  0.5487345997244 |     |        
 179000 |  3889 |  0.1176893478259 |     |        
 281000 |  6128 |  0.8585439366288 |     |        
 297000 |  6474 |  0.2585737025365 |     |        
 313000 |  6784 |  0.4113460863009 |     |        
 334000 |  7314 |  0.2497710692696 |     |        
 412000 |  9085 |  0.3718875120394 |     |        
 427000 |  9430 |  0.7756390087307 |     |        
 432000 |  9542 |  0.4672249867581 |     |        
 451000 | 10853 |                  |     |        
 452000 | 11853 | -0.7676992444322 |     |        
 453000 | 12853 | -0.6131584052928 |     |        
 454000 | 13853 | -0.6390553088859 |     |        
 455000 | 14853 | -0.0622924501076 |     |        
 456000 | 15853 |    -0.9822928668 |     |        
 457000 | 16853 | -0.0633100466803 |     |        
 458000 | 17853 | -0.6800268064253 |     |        
 459000 | 18853 | -0.7835058192723 |     |        
 460000 | 19853 | -0.6546622058377 |     |        
 461000 | 20853 |  0.2033609272912 |     |        
 462000 | 21853 |  0.6249915882945 |     |        
 463000 | 22853 |  -0.360319561325 |     |        
 464000 | 23853 |  0.6478354046121 |     |        
 465000 | 24853 |  0.7266592010856 |     |        
 466000 | 25853 |  0.9912370685488 |     |        
 467000 | 26853 | -0.0054406896234 |     |        
 468000 | 27853 | -0.3996169827878 |     |        
 469000 | 28853 | -0.4545523254201 |     |        
 470000 | 29853 |  0.3398638200015 |     |        
 471000 | 30853 |                  |     |        
 472000 | 31853 |                  |     |        
 473000 | 32853 |                  |     |        
 474000 | 33853 |                  |     |        
 475000 | 34853 |                  |     |        
 476000 | 35853 |                  |     |        
 477000 | 36853 |                  |     |        
 478000 | 37853 |                  |     |        
 479000 | 38853 |                  |     |        
 480000 | 39853 |                  |     |        
(41 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x >= s2.float_x) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   |     float_x      | id2 | float_x 
--------+-------+------------------+-----+---------
 235000 |  4947 |  0.9546461026184 |     |        
 238000 |  4993 |  0.5296760927886 |     |        
 251000 |  5310 |  0.4098354117014 |     |        
 269000 |  5666 |  0.2084929337725 |     |        
 279000 |  5904 |  0.6457925979048 |     |        
 311000 |  6555 |  0.7979098763317 |     |        
 328000 |  6907 |  0.1040899110958 |     |        
 330000 |  6975 |  0.6300356592983 |     |        
 367000 |  7684 |  0.8649718449451 |     |        
 388000 |  8095 |  0.7262684474699 |     |        
 395000 |  8263 |  0.9835044625215 |     |        
 448000 |  9320 |  0.3965655490756 |     |        
 484000 | 10247 | -0.1091087879613 |     |        
 485000 | 11247 | -0.4987082369626 |     |        
 486000 | 12247 |                  |     |        
 487000 | 13247 | -0.1031628982164 |     |        
 488000 | 14247 | -0.0438272808678 |     |        
 489000 | 15247 | -0.9497834043577 |     |        
 490000 | 16247 | -0.9397828364745 |     |        
 491000 | 17247 | -0.8386867465451 |     |        
 492000 | 18247 | -0.7932289745659 |     |        
 493000 | 19247 |  -0.338393652346 |     |        
 494000 | 20247 |  0.1283479686826 |     |        
 495000 | 21247 |  0.2663934603333 |     |        
 496000 | 22247 |  0.3939843950793 |     |        
 497000 | 23247 | -0.5770079074427 |     |        
 498000 | 24247 |  -0.334325867705 |     |        
 499000 | 25247 |  0.1363662527874 |     |        
 500000 | 26247 | -0.5942816538736 |     |        
 501000 | 27247 | -0.8640322526917 |     |        
 502000 | 28247 |  0.3883382985368 |     |        
 503000 | 29247 | -0.5118093434721 |     |        
 504000 | 30247 |                  |     |        
 505000 | 31247 |                  |     |        
 506000 | 32247 |                  |     |        
 507000 | 33247 |                  |     |        
 508000 | 34247 |                  |     |        
 509000 | 35247 |                  |     |        
 510000 | 36247 |                  |     |        
 511000 | 37247 |                  |     |        
 512000 | 38247 |                  |     |        
 513000 | 39247 |                  |     |        
(42 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x <= s2.float_x) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid  |  id   |     float_x      | id2 | float_x 
--------+-------+------------------+-----+---------
 153000 |  3239 |  0.0483138062991 |     |        
 166000 |  3595 |  0.4805290321819 |     |        
 169000 |  3645 |  0.5487345997244 |     |        
 179000 |  3889 |  0.1176893478259 |     |        
 281000 |  6128 |  0.8585439366288 |     |        
 297000 |  6474 |  0.2585737025365 |     |        
 313000 |  6784 |  0.4113460863009 |     |        
 334000 |  7314 |  0.2497710692696 |     |        
 412000 |  9085 |  0.3718875120394 |     |        
 427000 |  9430 |  0.7756390087307 |     |        
 432000 |  9542 |  0.4672249867581 |     |        
 451000 | 10853 |                  |     |        
 452000 | 11853 | -0.7676992444322 |     |        
 453000 | 12853 | -0.6131584052928 |     |        
 454000 | 13853 | -0.6390553088859 |     |        
 455000 | 14853 | -0.0622924501076 |     |        
 456000 | 15853 |    -0.9822928668 |     |        
 457000 | 16853 | -0.0633100466803 |     |        
 458000 | 17853 | -0.6800268064253 |     |        
 459000 | 18853 | -0.7835058192723 |     |        
 460000 | 19853 | -0.6546622058377 |     |        
 461000 | 20853 |  0.2033609272912 |     |        
 462000 | 21853 |  0.6249915882945 |     |        
 463000 | 22853 |  -0.360319561325 |     |        
 464000 | 23853 |  0.6478354046121 |     |        
 465000 | 24853 |  0.7266592010856 |     |        
 466000 | 25853 |  0.9912370685488 |     |        
 467000 | 26853 | -0.0054406896234 |     |        
 468000 | 27853 | -0.3996169827878 |     |        
 469000 | 28853 | -0.4545523254201 |     |        
 470000 | 29853 |  0.3398638200015 |     |        
 471000 | 30853 |                  |     |        
 472000 | 31853 |                  |     |        
 473000 | 32853 |                  |     |        
 474000 | 33853 |                  |     |        
 475000 | 34853 |                  |     |        
 476000 | 35853 |                  |     |        
 477000 | 36853 |                  |     |        
 478000 | 37853 |                  |     |        
 479000 | 38853 |                  |     |        
 480000 | 39853 |                  |     |        
(41 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 left outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x between s2.float_x and s2.float_x+0.05) as t where t.rowid%1000 = 0 and t.id2 is NULL;
 rowid |  id   |     float_x      | id2 | float_x 
-------+-------+------------------+-----+---------
  7000 |  1298 |  0.4617719594389 |     |        
 10000 |  1849 |  0.0007477598265 |     |        
 13000 |  2363 |  0.9984439513646 |     |        
 14000 |  2548 |  0.2198702665046 |     |        
 22000 |  4035 |  0.1130157527514 |     |        
 28000 |  5144 |  0.8944474360906 |     |        
 35000 |  6460 |  0.7615142962895 |     |        
 39000 |  7202 |  0.8203820134513 |     |        
 46000 |  8516 |  0.2778520719148 |     |        
 54000 | 10092 | -0.9176025749184 |     |        
 55000 | 11092 | -0.5805652863346 |     |        
 56000 | 12092 | -0.4509220020846 |     |        
 57000 | 13092 | -0.7050508302636 |     |        
 58000 | 14092 | -0.2492549782619 |     |        
 59000 | 15092 | -0.8389784977771 |     |        
 60000 | 16092 | -0.7483518803492 |     |        
 61000 | 17092 | -0.6907529956661 |     |        
 62000 | 18092 | -0.4973171884194 |     |        
 63000 | 19092 |   -0.47663683258 |     |        
 64000 | 20092 | -0.8468807311729 |     |        
 65000 | 21092 | -0.0284360609949 |     |        
 66000 | 22092 |  0.9988136412576 |     |        
 67000 | 23092 |  0.8490045014769 |     |        
 68000 | 24092 | -0.3487110240385 |     |        
 69000 | 25092 |   0.423818369396 |     |        
 70000 | 26092 | -0.3822553418577 |     |        
 71000 | 27092 |  0.3451447859406 |     |        
 72000 | 28092 | -0.4184181187302 |     |        
 73000 | 29092 |  0.2079220963642 |     |        
 74000 | 30092 |                  |     |        
 75000 | 31092 |                  |     |        
 76000 | 32092 |                  |     |        
 77000 | 33092 |                  |     |        
 78000 | 34092 |                  |     |        
 79000 | 35092 |                  |     |        
 80000 | 36092 |                  |     |        
 81000 | 37092 |                  |     |        
 82000 | 38092 |                  |     |        
 83000 | 39092 |                  |     |        
(39 rows)

--Right Outer Join ( REVERSE inner and outer )
select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x > s2.float_x) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | float_x |  id2  |     float_x      
--------+----+---------+-------+------------------
 475000 |    |         |   313 |  0.9377145417966
 476000 |    |         |  1418 |  0.5468468721956
 477000 |    |         |  2519 |  0.4035681826063
 478000 |    |         |  3623 |  0.4145472459495
 479000 |    |         |  4729 |  0.4242266723886
 480000 |    |         |  5834 |  0.2421278003603
 481000 |    |         |  6939 |                 
 482000 |    |         |  8045 |  0.2082794164307
 483000 |    |         |  9154 |  0.6663965620101
 484000 |    |         | 10233 | -0.6411713194102
 485000 |    |         | 11233 | -0.2809426230378
 486000 |    |         | 12233 | -0.5960695319809
 487000 |    |         | 13233 | -0.1153141004033
 488000 |    |         | 14233 | -0.0716026695445
 489000 |    |         | 15233 | -0.9777649259195
 490000 |    |         | 16233 | -0.9264747644775
 491000 |    |         | 17233 | -0.6455535502173
 492000 |    |         | 18233 | -0.1225513927639
 493000 |    |         | 19233 | -0.4278407702222
 494000 |    |         | 20233 | -0.0410501714796
 495000 |    |         | 21233 |  0.5358419120312
 496000 |    |         | 22233 | -0.4777822848409
 497000 |    |         | 23233 |                 
 498000 |    |         | 24233 |                 
 499000 |    |         | 25233 | -0.2824882278219
 500000 |    |         | 26233 | -0.3925506966189
 501000 |    |         | 27233 |  0.6097913924605
 502000 |    |         | 28233 | -0.3609829358757
 503000 |    |         | 29233 | -0.8098866390064
 504000 |    |         | 30233 |                 
 505000 |    |         | 31233 |                 
 506000 |    |         | 32233 |                 
 507000 |    |         | 33233 |                 
 508000 |    |         | 34233 |                 
 509000 |    |         | 35233 |                 
 510000 |    |         | 36233 |                 
 511000 |    |         | 37233 |                 
 512000 |    |         | 38233 |                 
 513000 |    |         | 39233 |                 
(39 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x < s2.float_x) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | float_x |  id2  |     float_x      
--------+----+---------+-------+------------------
 442000 |    |         |   983 |  0.5605953997001
 443000 |    |         |  2084 |  0.3390023298562
 444000 |    |         |  3188 |  0.7029946702532
 445000 |    |         |  4293 |  0.7758477414027
 446000 |    |         |  5397 |  0.4482731255703
 447000 |    |         |  6501 |  0.1939382832497
 448000 |    |         |  7607 |  0.8895894419402
 449000 |    |         |  8716 |  0.3715710318647
 450000 |    |         |  9823 |   0.185723233968
 451000 |    |         | 10840 | -0.3591940985061
 452000 |    |         | 11840 | -0.5234298128635
 453000 |    |         | 12840 | -0.4072793736123
 454000 |    |         | 13840 | -0.9738821554929
 455000 |    |         | 14840 | -0.7512619225308
 456000 |    |         | 15840 | -0.0964302080683
 457000 |    |         | 16840 | -0.0885328990407
 458000 |    |         | 17840 | -0.1417955625802
 459000 |    |         | 18840 | -0.7481145486236
 460000 |    |         | 19840 | -0.0438608922996
 461000 |    |         | 20840 |                 
 462000 |    |         | 21840 |  0.8894999567419
 463000 |    |         | 22840 |   0.831095312722
 464000 |    |         | 23840 |  0.2720593800768
 465000 |    |         | 24840 |  0.0784302279353
 466000 |    |         | 25840 | -0.9509206674993
 467000 |    |         | 26840 |  0.2137804366648
 468000 |    |         | 27840 |  0.2456965697929
 469000 |    |         | 28840 |    0.59655463323
 470000 |    |         | 29840 |  0.5864889472723
 471000 |    |         | 30840 |                 
 472000 |    |         | 31840 |                 
 473000 |    |         | 32840 |                 
 474000 |    |         | 33840 |                 
 475000 |    |         | 34840 |                 
 476000 |    |         | 35840 |                 
 477000 |    |         | 36840 |                 
 478000 |    |         | 37840 |                 
 479000 |    |         | 38840 |                 
 480000 |    |         | 39840 |                 
(39 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x >= s2.float_x) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | float_x |  id2  |     float_x      
--------+----+---------+-------+------------------
 475000 |    |         |   313 |  0.9377145417966
 476000 |    |         |  1418 |  0.5468468721956
 477000 |    |         |  2519 |  0.4035681826063
 478000 |    |         |  3623 |  0.4145472459495
 479000 |    |         |  4729 |  0.4242266723886
 480000 |    |         |  5834 |  0.2421278003603
 481000 |    |         |  6939 |                 
 482000 |    |         |  8045 |  0.2082794164307
 483000 |    |         |  9154 |  0.6663965620101
 484000 |    |         | 10233 | -0.6411713194102
 485000 |    |         | 11233 | -0.2809426230378
 486000 |    |         | 12233 | -0.5960695319809
 487000 |    |         | 13233 | -0.1153141004033
 488000 |    |         | 14233 | -0.0716026695445
 489000 |    |         | 15233 | -0.9777649259195
 490000 |    |         | 16233 | -0.9264747644775
 491000 |    |         | 17233 | -0.6455535502173
 492000 |    |         | 18233 | -0.1225513927639
 493000 |    |         | 19233 | -0.4278407702222
 494000 |    |         | 20233 | -0.0410501714796
 495000 |    |         | 21233 |  0.5358419120312
 496000 |    |         | 22233 | -0.4777822848409
 497000 |    |         | 23233 |                 
 498000 |    |         | 24233 |                 
 499000 |    |         | 25233 | -0.2824882278219
 500000 |    |         | 26233 | -0.3925506966189
 501000 |    |         | 27233 |  0.6097913924605
 502000 |    |         | 28233 | -0.3609829358757
 503000 |    |         | 29233 | -0.8098866390064
 504000 |    |         | 30233 |                 
 505000 |    |         | 31233 |                 
 506000 |    |         | 32233 |                 
 507000 |    |         | 33233 |                 
 508000 |    |         | 34233 |                 
 509000 |    |         | 35233 |                 
 510000 |    |         | 36233 |                 
 511000 |    |         | 37233 |                 
 512000 |    |         | 38233 |                 
 513000 |    |         | 39233 |                 
(39 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x <= s2.float_x) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid  | id | float_x |  id2  |     float_x      
--------+----+---------+-------+------------------
 442000 |    |         |   983 |  0.5605953997001
 443000 |    |         |  2084 |  0.3390023298562
 444000 |    |         |  3188 |  0.7029946702532
 445000 |    |         |  4293 |  0.7758477414027
 446000 |    |         |  5397 |  0.4482731255703
 447000 |    |         |  6501 |  0.1939382832497
 448000 |    |         |  7607 |  0.8895894419402
 449000 |    |         |  8716 |  0.3715710318647
 450000 |    |         |  9823 |   0.185723233968
 451000 |    |         | 10840 | -0.3591940985061
 452000 |    |         | 11840 | -0.5234298128635
 453000 |    |         | 12840 | -0.4072793736123
 454000 |    |         | 13840 | -0.9738821554929
 455000 |    |         | 14840 | -0.7512619225308
 456000 |    |         | 15840 | -0.0964302080683
 457000 |    |         | 16840 | -0.0885328990407
 458000 |    |         | 17840 | -0.1417955625802
 459000 |    |         | 18840 | -0.7481145486236
 460000 |    |         | 19840 | -0.0438608922996
 461000 |    |         | 20840 |                 
 462000 |    |         | 21840 |  0.8894999567419
 463000 |    |         | 22840 |   0.831095312722
 464000 |    |         | 23840 |  0.2720593800768
 465000 |    |         | 24840 |  0.0784302279353
 466000 |    |         | 25840 | -0.9509206674993
 467000 |    |         | 26840 |  0.2137804366648
 468000 |    |         | 27840 |  0.2456965697929
 469000 |    |         | 28840 |    0.59655463323
 470000 |    |         | 29840 |  0.5864889472723
 471000 |    |         | 30840 |                 
 472000 |    |         | 31840 |                 
 473000 |    |         | 32840 |                 
 474000 |    |         | 33840 |                 
 475000 |    |         | 34840 |                 
 476000 |    |         | 35840 |                 
 477000 |    |         | 36840 |                 
 478000 |    |         | 37840 |                 
 479000 |    |         | 38840 |                 
 480000 |    |         | 39840 |                 
(39 rows)

select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 right outer join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x between s2.float_x and s2.float_x+0.05) as t where t.rowid%1000 = 0 and t.id is NULL;
 rowid | id | float_x |  id2  |     float_x      
-------+----+---------+-------+------------------
 45000 |    |         |   144 |  0.3872726745903
 46000 |    |         |  1247 |   0.395069824066
 47000 |    |         |  2349 |  0.2479577646591
 48000 |    |         |  3454 |  0.7549412767403
 49000 |    |         |  4557 |  0.3109976584092
 50000 |    |         |  5664 |  0.5723694935441
 51000 |    |         |  6767 |  0.8728875527158
 52000 |    |         |  7873 |   0.923590018414
 53000 |    |         |  8981 |  0.2778403004631
 54000 |    |         | 10078 | -0.7954898658209
 55000 |    |         | 11078 | -0.3996764114127
 56000 |    |         | 12078 |  -0.559279515408
 57000 |    |         | 13078 | -0.5662146615796
 58000 |    |         | 14078 | -0.9723450010642
 59000 |    |         | 15078 | -0.5593094420619
 60000 |    |         | 16078 | -0.0164865949191
 61000 |    |         | 17078 | -0.7660327535123
 62000 |    |         | 18078 | -0.8433622033335
 63000 |    |         | 19078 |  -0.343482194934
 64000 |    |         | 20078 |  0.5555201750249
 65000 |    |         | 21078 |  0.2647949522361
 66000 |    |         | 22078 |  0.6815999215469
 67000 |    |         | 23078 |  0.2579650012776
 68000 |    |         | 24078 |  0.1776549248025
 69000 |    |         | 25078 |  0.6977377673611
 70000 |    |         | 26078 |  0.5199068160728
 71000 |    |         | 27078 |  0.0772106116638
 72000 |    |         | 28078 |  0.0378381852061
 73000 |    |         | 29078 |  0.5492433048785
 74000 |    |         | 30078 |                 
 75000 |    |         | 31078 |                 
 76000 |    |         | 32078 |                 
 77000 |    |         | 33078 |                 
 78000 |    |         | 34078 |                 
 79000 |    |         | 35078 |                 
 80000 |    |         | 36078 |                 
 81000 |    |         | 37078 |                 
 82000 |    |         | 38078 |                 
 83000 |    |         | 39078 |                 
(39 rows)

--Full Join ( NOT supported error )
select * from (select row_number() over(order by s1.id,s2.id) as rowid,s1.id,s1.float_x,s2.id as id2,s2.float_x from strom_test s1 FULL join strom_test s2 on s1.key=1 and s2.key=2 and s1.float_x > s2.float_x) as t where t.rowid%1000 = 0 and t.id is NULL;
ERROR:  FULL JOIN is only supported with merge-joinable or hash-joinable join conditions
